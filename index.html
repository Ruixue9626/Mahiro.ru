<!DOCTYPE html><html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>PDF è³‡æºå¹³å°</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    .hidden { display: none; }
    iframe { width: 100%; height: 500px; border: none; }
  </style>
</head>
<body>
<div class="container">
  <h2>ğŸ“¢ ä½¿ç”¨è€…è¦ç¯„ / å…è²¬è²æ˜</h2>
  <ul>
    <li>1. æœ¬ç«™æ‰€æœ‰è³‡æºã€å¸³è™Ÿç”± GitHub æä¾›ï¼Œç„¡ç›œç”¨æˆ–éæ³•è¡Œç‚ºã€‚</li>
    <li>2. æŠ„ä½œæ¥­å°è‡´è² é¢å½±éŸ¿ï¼Œç®¡ç†è€…ä¸è² è²¬ã€‚</li>
    <li>3. ä½¿ç”¨å•é¡Œç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ“”ã€‚</li>
    <li>4. åš´ç¦åˆ©ç”¨æœ¬ç«™ä½œå¼Šã€‚</li>
  </ul>
  <button onclick="acceptDisclaimer()">æˆ‘å·²é–±è®€ä¸¦åŒæ„</button>  <div id="login" class="hidden">
    <h3>ç™»å…¥</h3>
    <input id="user" placeholder="å¸³è™Ÿ"><br><br>
    <input id="pass" type="password" placeholder="å¯†ç¢¼"><br><br>
    <button onclick="login()">ç™»å…¥</button>
    <p id="error" style="color:red"></p>
  </div>  <div id="app" class="hidden">
    <h3>PDF æª”æ¡ˆåˆ—è¡¨</h3>
    <div id="pdfList"></div>
    <div id="uploadArea" class="hidden">
      <hr>
      <h4>ä¸Šå‚³ PDF</h4>
      <input type="file" id="pdfFile"><br><br>
      <button onclick="uploadPdf()">ä¸Šå‚³</button>
      <p id="uploadStatus"></p>
    </div>
    <div id="viewer"></div>
    <br><button onclick="logout()">ç™»å‡º</button>
  </div>
</div><script>
  const USERS = {
    user01: { pw: '0123', role: 'user' },
    Ruixue: { pw: '0325', role: 'admin' }
  };
  let currentUser = null;

  function acceptDisclaimer() {
    document.getElementById('login').classList.remove('hidden');
  }

  function login() {
    const u = document.getElementById('user').value;
    const p = document.getElementById('pass').value;
    const error = document.getElementById('error');
    if (USERS[u] && USERS[u].pw === p) {
      currentUser = { name: u, role: USERS[u].role };
      document.getElementById('login').classList.add('hidden');
      document.getElementById('app').classList.remove('hidden');
      if (currentUser.role === 'admin') {
        document.getElementById('uploadArea').classList.remove('hidden');
      }
      fetchPdfs();
    } else {
      error.textContent = 'å¸³å¯†éŒ¯èª¤';
    }
  }

  function logout() {
    location.reload();
  }

  function fetchPdfs() {
    fetch('/api/pdfs')
      .then(res => res.json())
      .then(files => {
        const list = document.getElementById('pdfList');
        list.innerHTML = '';
        files.forEach(f => {
          const a = document.createElement('a');
          a.textContent = f;
          a.href = '#';
          a.onclick = () => viewPdf(f);
          a.style.display = 'block';
          list.appendChild(a);
        });
      });
  }

  function viewPdf(filename) {
    const viewer = document.getElementById('viewer');
    viewer.innerHTML = `<iframe src="/uploads/${filename}#toolbar=0&navpanes=0"></iframe>`;
  }

  function uploadPdf() {
    const fileInput = document.getElementById('pdfFile');
    const status = document.getElementById('uploadStatus');
    const file = fileInput.files[0];
    if (!file || !file.name.endsWith('.pdf')) {
      alert('è«‹é¸æ“‡ PDF æª”æ¡ˆ');
      return;
    }
    const formData = new FormData();
    formData.append('pdf', file);
    fetch('/api/upload', { method: 'POST', body: formData })
      .then(res => res.json())
      .then(data => {
        status.textContent = 'âœ… ä¸Šå‚³æˆåŠŸï¼š' + data.filename;
        fetchPdfs();
      })
      .catch(() => status.textContent = 'âŒ ä¸Šå‚³å¤±æ•—');
  }
</script></body>
</html>
